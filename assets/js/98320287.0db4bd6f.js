"use strict";(self.webpackChunkstatemesh_docs=self.webpackChunkstatemesh_docs||[]).push([[3706],{8966:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>x,contentTitle:()=>p,default:()=>b,frontMatter:()=>m,metadata:()=>s,toc:()=>j});const s=JSON.parse('{"id":"architecture/global","title":"How StateMesh Works","description":"StateMesh runs customer workloads in various geographic regions to make the network globally available to users worldwide. Each geographic region can have one or more clusters of nodes called availability zones. Currently, the following regions and zones are available or planned for the near future:","source":"@site/docs/architecture/global.mdx","sourceDirName":"architecture","slug":"/architecture/global","permalink":"/architecture/global","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"How StateMesh Works"},"sidebar":"mySidebar","previous":{"title":"Quickstart Guide","permalink":"/getting-started/quickstart"},"next":{"title":"Blockchain Architecture","permalink":"/architecture/blockchain"}}');var i=t(4848),r=t(8453),o=t(9844),a=t(9591),l=t(3881),c=t(618),h=t(3231),d=t(6780),u=t(8933),g=t(4744);const m={title:"How StateMesh Works"},p=void 0,x={},j=[{value:"Architecture",id:"architecture",level:2},{value:"Regions",id:"regions",level:3},{value:"Availability Zones",id:"availability-zones",level:3},{value:"Node Cluster",id:"node-cluster",level:4},{value:"Ingress routing",id:"ingress-routing",level:4},{value:"Nodes",id:"nodes",level:3},{value:"Blockchain",id:"blockchain",level:3},{value:"Time Towers",id:"time-towers",level:4}];function f(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"StateMesh runs customer workloads in various geographic regions to make the network globally available to users worldwide. Each geographic region can have one or more clusters of nodes called availability zones. Currently, the following regions and zones are available or planned for the near future:"}),"\n",(0,i.jsx)(a.A,{className:"mb-1",children:(0,i.jsxs)(l.A,{"aria-label":"Available zones",size:"small",children:[(0,i.jsx)(c.A,{children:(0,i.jsxs)(h.A,{children:[(0,i.jsx)(d.A,{children:"Region"}),(0,i.jsx)(d.A,{children:"Availability Zone"}),(0,i.jsx)(d.A,{children:"Status"})]})}),(0,i.jsxs)(u.A,{children:[(0,i.jsxs)(h.A,{children:[(0,i.jsx)(d.A,{children:"Europe"}),(0,i.jsx)(d.A,{children:"eu-central-1"}),(0,i.jsx)(d.A,{children:(0,i.jsx)(g.A,{label:"Live",size:"small",color:"success"})})]}),(0,i.jsxs)(h.A,{children:[(0,i.jsx)(d.A,{children:"Europe"}),(0,i.jsx)(d.A,{children:"eu-north-1"}),(0,i.jsx)(d.A,{children:(0,i.jsx)(g.A,{label:"Planned",size:"small"})})]}),(0,i.jsxs)(h.A,{children:[(0,i.jsx)(d.A,{children:"Singapore"}),(0,i.jsx)(d.A,{children:"sg-1"}),(0,i.jsx)(d.A,{children:(0,i.jsx)(g.A,{label:"Live",size:"small",color:"success"})})]}),(0,i.jsxs)(h.A,{children:[(0,i.jsx)(d.A,{children:"US East"}),(0,i.jsx)(d.A,{children:"us-east-1"}),(0,i.jsx)(d.A,{children:(0,i.jsx)(g.A,{label:"Planned",size:"small"})})]}),(0,i.jsxs)(h.A,{children:[(0,i.jsx)(d.A,{children:"US West"}),(0,i.jsx)(d.A,{children:"us-west-1"}),(0,i.jsx)(d.A,{children:(0,i.jsx)(g.A,{label:"Planned",size:"small"})})]}),(0,i.jsxs)(h.A,{children:[(0,i.jsx)(d.A,{children:"Hong Kong"}),(0,i.jsx)(d.A,{children:"hk-1"}),(0,i.jsx)(d.A,{children:(0,i.jsx)(g.A,{label:"Planned",size:"small"})})]}),(0,i.jsxs)(h.A,{children:[(0,i.jsx)(d.A,{children:"India"}),(0,i.jsx)(d.A,{children:"in-1"}),(0,i.jsx)(d.A,{children:(0,i.jsx)(g.A,{label:"Planned",size:"small"})})]})]})]})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"We are always open to adding more regions and zones based on customer demand."})}),"\n",(0,i.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,i.jsx)(n.p,{children:"The StateMesh network is comprised or Regions, Availability Zones, Nodes and the StateMesh Blockchain."}),"\n",(0,i.jsx)(o.A,{darkSrc:"/img/architecture-dark.png",src:"/img/architecture-light.png",alt:"StateMesh Network Architecture",caption:"StateMesh Network Architecture"}),"\n",(0,i.jsx)(n.p,{children:"The entire system is an interplay of hardware and software components that work together to provide a reliable, secure and performant platform for running customer workloads. The network is designed to be highly available, fault-tolerant and scalable. It is built on top of proven technologies and best practices in the industry."}),"\n",(0,i.jsx)(n.h3,{id:"regions",children:"Regions"}),"\n",(0,i.jsx)(n.p,{children:"A region is a geographical that has one or more availability zones."}),"\n",(0,i.jsx)(o.A,{darkSrc:"/img/regions-and-zones-dark.png",src:"/img/regions-and-zones-light.png",alt:"StateMesh Regions and Availability Zones",caption:"Regions and Availability Zones"}),"\n",(0,i.jsxs)(n.p,{children:["Regions maintain a global view of their network and are responsible for securing inter-zone communication or even provide inter-zone communication if necessary. Each region has its own mesh private network that is not accessible from the public internet. It's a VPN-like network optimized for low latency and high throughput, with ",(0,i.jsx)(n.a,{href:"http://cr.yp.to/chacha.html",children:"ChaCha20"})," encryption with ",(0,i.jsx)(n.a,{href:"http://cr.yp.to/mac.html",children:"Poly1305"})," authentication, dynamic route assignments and MTU management and dynamic membership. The mesh network runs in kernel space to provide the best performance."]}),"\n",(0,i.jsx)(n.p,{children:"The mesh network introduces a latency compared to the public internet, it's impact is negligible for most workloads. Our benchmarks show that the extra latency is around 0.1ms and the throughput is around 50% of the public network bandwidth. Over a 10Gbps public network, the mesh network can provide around 5Gbps of throughput."}),"\n",(0,i.jsx)(n.h3,{id:"availability-zones",children:"Availability Zones"}),"\n",(0,i.jsx)(n.p,{children:"Each availability zone is a cluster of nodes that are geographically close to each other. Each node is operated by a node operator, and node operators are responsible for running the node software and for maintaining the node's uptime."}),"\n",(0,i.jsx)(n.p,{children:"While a technical solution is already in place to enable cross-zone communication at the region level, we could not find a valid use-case to enable it. We are open to enabling cross-zone communication if there is a valid use-case for it."}),"\n",(0,i.jsx)(n.p,{children:"The main software components of an availability zone are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Master Nodes"}),": cluster services for crowd-sourcing compute resources, work distribution, and task execution"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Metric & Billing services"}),": services that collect metrics, compute billing information and handle payments"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ingress Routers"}),": services that routes incoming requests to the correct node in the cluster, with policies for traffic shaping and rate limiting"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Network Storage Services"}),": services that aggregate storage from nodes and attaches them as block devices to customer workloads. Handles replication, backup, and recovery."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"BYOS"}),": ",(0,i.jsx)(n.strong,{children:"B"}),"ring ",(0,i.jsx)(n.strong,{children:"Y"}),"our ",(0,i.jsx)(n.strong,{children:"O"}),"wn ",(0,i.jsx)(n.strong,{children:"S"}),"torage services that allow customers to bring their own S3-compatible storage to the network. This includes advanced metadata caching and storage"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Nodes"}),": the actual compute nodes that run customer workloads and/or provide storage"]}),"\n"]}),"\n",(0,i.jsx)(o.A,{darkSrc:"/img/availability-zone-dark.png",src:"/img/availability-zone-light.png",alt:"Architecture of a StateMesh Availability Zone",caption:"Architecture of an Availability Zone"}),"\n",(0,i.jsx)(n.h4,{id:"node-cluster",children:"Node Cluster"}),"\n",(0,i.jsx)(n.p,{children:"By far the most complex software component of an Availability Zone is the node cluster. At its core it uses Kubernetes to orchestrate customer workloads like containers, storage, networking and virtual machines, but is heavily customized for edge computing and to fit the unique needs of the StateMesh network."}),"\n",(0,i.jsx)(n.p,{children:"This component handles the following tasks:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Task scheduling and execution"}),": The node cluster is responsible for scheduling and executing customer workloads. It uses a custom scheduler that takes into account the Time Tower of the node operator, the customer's requirements, the node's capabilities and the current load of the node."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Node monitoring and health checks"}),": The node cluster monitors the health of the nodes and the workloads running on them. It uses a custom health check system that is optimized for low latency and high throughput."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Intra-zone routing and networking"}),": Handles IP assignments, ingress and routes intra-zone container and VM traffic. It uses eBPF to provide the best performance and minimal latency."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Load balancing and failover"}),": Manages the load balancing and automatic failover of customer workloads for including HTTP, TCP and UDP traffic."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Workflow storage management"}),": Manages the storage of customer workloads, including block storage, object storage and file storage. It uses a custom storage system that is optimized for low latency and high throughput."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Node operator management"}),": Manages the node operators, their Time Towers, their rewards and their onboarding."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Security policies"}),": Enforces security policies like customer workload isolation and access control lists."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The node cluster software also handles nodes coming online and going offline, and is able to quickly recover from node failures. If a node fails, the node cluster will automatically reschedule the workloads running on the failed node to other nodes in the cluster in a matter of seconds."}),"\n",(0,i.jsx)(n.h4,{id:"ingress-routing",children:"Ingress routing"}),"\n",(0,i.jsx)(n.p,{children:"Ingress routing services handle north-south traffic and routes it to the correct node and container in the cluster. It also handles rate limiting, traffic shaping and DDoS protection."}),"\n",(0,i.jsxs)(n.p,{children:["Each workload running on StateMesh can be exposed to the outside world using a generated public DNS address over a TLS connection (eg: ",(0,i.jsx)(n.code,{children:"https://app-abcdef-xjlfg.eu-central-1.statemesh.net"}),". Routing is performed based on hostname and path for HTTPS services and TLS SNI for TCP services. Because UDP traffic does not support TLS, routing is based on the incoming port."]}),"\n",(0,i.jsx)(o.A,{darkSrc:"/img/ingress-traffic-dark.png",src:"/img/ingress-traffic-light.png",alt:"StateMesh Ingress routing",caption:"StateMesh Ingress routing"}),"\n",(0,i.jsx)(n.h3,{id:"nodes",children:"Nodes"}),"\n",(0,i.jsxs)(n.p,{children:["Worker nodes are the actual compute nodes that run customer workloads. They can be virtual machines or physical machines with an ",(0,i.jsx)(n.code,{children:"x86-64"})," or ",(0,i.jsx)(n.code,{children:"amd64"})," CPU architecture. ",(0,i.jsx)(n.code,{children:"arm64"})," is on the roadmap and planned in next releases."]}),"\n",(0,i.jsx)(n.p,{children:"Nodes are operated by node operators. Each node operator is responsible for maintaining the node's uptime and keeping a minimum MESH balance to confirm the node's presence on the network."}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"MESH is used only for paying gas fees associated with confirming the node's presence on the network."})}),"\n",(0,i.jsx)(n.p,{children:"Nodes must run a fresh installation of the Ubuntu 22.04 operating system. Other configurations are not supported."}),"\n",(0,i.jsx)(n.h3,{id:"blockchain",children:"Blockchain"}),"\n",(0,i.jsx)(n.p,{children:"StateMesh uses its own L1 blockchain to store and validate node states using Time Towers. At the end of each chain epoch, the tower registry is reconfigured for each availability zone to reflect jailed nodes and elected node operators for the next epoch."}),"\n",(0,i.jsx)(n.p,{children:"The blockchain is also used to handle automated stablecoin payments and bridging stablecoins from/to Statemesh to other blockchains."}),"\n",(0,i.jsx)(n.h4,{id:"time-towers",children:"Time Towers"}),"\n",(0,i.jsxs)(n.p,{children:["Each node operator must run the StateMesh ",(0,i.jsx)(n.a,{href:"/architecture/time-towers",children:"Tower Service"})," service on his machine to join the global miner pool. Being in the miner pool is necessary to be able to join a cluster. The higher the Time Tower, the more likely the node is to be elected for task execution."]})]})}function b(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(f,{...e})}):f(e)}},9844:(e,n,t)=>{t.d(n,{A:()=>o});t(6540);var s=t(6025),i=t(5293),r=t(4848);function o(e){let{src:n,darkSrc:t,caption:o}=e;const a="dark"===(0,i.G)().colorMode,l=t||n;return(0,r.jsxs)("figure",{style:{padding:20},children:[(0,r.jsx)("img",{src:a?(0,s.Ay)(l):(0,s.Ay)(n),alt:o}),o&&(0,r.jsx)("figcaption",{style:{textAlign:"center",fontWeight:200,marginTop:"1rem"},children:`Figure: ${o}`})]})}}}]);